<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bluesky OAuth Redirect</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: sans-serif; display:flex; align-items:center; justify-content:center; height:100vh; margin:0; }
  </style>
</head>
<body>
  <p id="status">Redirecting…</p>
  <script>
  (function() {
    function getQueryAndHash() {
      const search = window.location.search; // includes "?"
      const hash = window.location.hash;     // includes "#"
      if (search && search.length > 1) {
        return search;                       // ?code=...&state=...
      }
      if (hash && hash.length > 1) {
        return '?' + hash.substring(1);      // #code=... -> ?code=...
      }
      return '';
    }

    const params = getQueryAndHash();
    const target = 'flare://Callback/SignIn/Bluesky' + params;

    try {
      // Replace current history entry so back button doesn’t return here
      window.location.replace(target);
    } catch (_) {
      // Fallback for browsers that block automatic custom‑scheme redirects
      const status = document.getElementById('status');
      status.innerHTML = 'If you are not redirected automatically, <a href="' + target + '">tap here</a>.';
    }
  })();
  </script>
</body>
</html>
